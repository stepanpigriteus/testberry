<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Order Viewer</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f8fa; padding: 20px; }
    .order-card { background: white; border: 1px solid #e1e8ed; border-radius: 10px; padding: 15px; margin-top: 20px; max-width: 800px; }
    .section { margin-bottom: 15px; }
    .section h3 { margin-bottom: 5px; border-bottom: 1px solid #ccc; padding-bottom: 5px; }
    .field { margin: 3px 0; }
    input { padding: 5px; width: 300px; }
    button { padding: 5px 10px; }
    .item { margin-bottom: 10px; padding-left: 10px; border-left: 2px solid #ccc; }
  </style>
</head>
<body>
  <h1>Order Viewer</h1>
  <input type="text" id="uid" placeholder="Enter Order UID">
  <button onclick="getOrder()">Get Order</button>

  <div id="result"></div>

  <script>
    async function getOrder() {
    const uid = document.getElementById("uid").value.trim();
    if (!uid) return alert("Enter UID!");

    try {
        const res = await fetch(`http://localhost:8081/order/${uid}`);

        if (!res.ok) {
        const errorText = await res.text();
        return alert(`Error ${res.status}: ${errorText}`);
        }

    const order = await res.json();

      const delivery = order.delivery;
      const payment = order.payment;
      const items = order.items;

      document.getElementById("result").innerHTML = `
        <div class="order-card">
          <div class="section">
            <h3>Order Info</h3>
            <div class="field"><strong>UID:</strong> ${order.order_uid}</div>
            <div class="field"><strong>Track Number:</strong> ${order.track_number}</div>
            <div class="field"><strong>Entry:</strong> ${order.entry}</div>
            <div class="field"><strong>Locale:</strong> ${order.locale}</div>
            <div class="field"><strong>Internal Signature:</strong> ${order.internal_signature || '-'}</div>
            <div class="field"><strong>Customer ID:</strong> ${order.customer_id}</div>
            <div class="field"><strong>Delivery Service:</strong> ${order.delivery_service}</div>
            <div class="field"><strong>Shardkey:</strong> ${order.shardkey}</div>
            <div class="field"><strong>Sm ID:</strong> ${order.sm_id}</div>
            <div class="field"><strong>Date Created:</strong> ${new Date(order.date_created).toLocaleString()}</div>
            <div class="field"><strong>Oof Shard:</strong> ${order.oof_shard}</div>
          </div>

          <div class="section">
            <h3>Delivery</h3>
            <div class="field"><strong>Name:</strong> ${delivery.name}</div>
            <div class="field"><strong>Phone:</strong> ${delivery.phone}</div>
            <div class="field"><strong>Zip:</strong> ${delivery.zip}</div>
            <div class="field"><strong>City:</strong> ${delivery.city}</div>
            <div class="field"><strong>Address:</strong> ${delivery.address}</div>
            <div class="field"><strong>Region:</strong> ${delivery.region}</div>
            <div class="field"><strong>Email:</strong> ${delivery.email}</div>
          </div>

          <div class="section">
            <h3>Payment</h3>
            <div class="field"><strong>Transaction:</strong> ${payment.transaction}</div>
            <div class="field"><strong>Request ID:</strong> ${payment.request_id}</div>
            <div class="field"><strong>Currency:</strong> ${payment.currency}</div>
            <div class="field"><strong>Provider:</strong> ${payment.provider}</div>
            <div class="field"><strong>Amount:</strong> $${payment.amount}</div>
            <div class="field"><strong>Payment Date:</strong> ${new Date(payment.payment_dt * 1000).toLocaleString()}</div>
            <div class="field"><strong>Bank:</strong> ${payment.bank}</div>
            <div class="field"><strong>Delivery Cost:</strong> $${payment.delivery_cost}</div>
            <div class="field"><strong>Goods Total:</strong> $${payment.goods_total}</div>
            <div class="field"><strong>Custom Fee:</strong> $${payment.custom_fee}</div>
          </div>

          <div class="section">
            <h3>Items (${items.length})</h3>
            ${items.map((item, i) => `
              <div class="item">
                <div class="field"><strong>#${i + 1}: ${item.name}</strong></div>
                <div class="field"><strong>Chrt ID:</strong> ${item.chrt_id}</div>
                <div class="field"><strong>Track Number:</strong> ${item.track_number}</div>
                <div class="field"><strong>Price:</strong> $${item.price}</div>
                <div class="field"><strong>Rid:</strong> ${item.rid}</div>
                <div class="field"><strong>Sale:</strong> ${item.sale}%</div>
                <div class="field"><strong>Size:</strong> ${item.size}</div>
                <div class="field"><strong>Total Price:</strong> $${item.total_price}</div>
                <div class="field"><strong>Nm ID:</strong> ${item.nm_id}</div>
                <div class="field"><strong>Brand:</strong> ${item.brand}</div>
                <div class="field"><strong>Status:</strong> ${item.status}</div>
              </div>
            `).join("")}
          </div>
        </div>
      `;
       } catch (err) {
            alert("Network error: " + err.message);
        }
    }
    
  </script>
</body>
</html>
