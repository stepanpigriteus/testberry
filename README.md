# testberry

## Задание
Необходимо разработать демонстрационный сервис с простейшим интерфейсом, отображающий данные о заказе.

Данное задание предполагает создание небольшого микросервиса на Go с использованием базы данных и очереди сообщений. Сервис будет получать данные заказов из очереди (Kafka), сохранять их в базу данных (PostgreSQL) и кэшировать в памяти для быстрого доступа.

## Что нужно сделать:

### Развернуть локально базу данных:
- Cоздать новую базу данных для сервиса
- Настроить пользователя: заведите пользователя и выдайте права на созданную БД
- Создать таблицы: спроектируйте структуру для хранения полученных данных о заказах, ориентируясь на прилагаемую модель данных.

### Разработать сервис:
- Написать приложение на Go, реализующее описанные ниже функции.
- Разработать простейший интерфейс для отображения полученных данных по ID заказа.
- Подключиться и подписаться на канал сообщений: настроить получение данных из брокера сообщений (Kafka).
- Сохранять полученные данные в БД: при приходе нового сообщения о заказе, парсить его и вставлять соответствующую запись(и) в базу данных (PostgreSQL).
- Реализовать кэширование данных в сервисе: хранить последние полученные данные заказов в памяти (например, в map), чтобы быстро выдавать их по запросу.
- При перезапуске восстанавливать кеш из БД: при старте сервиса заполнять кеш актуальными данными из базы, чтобы продолжить обслуживание запросов без задержек.
- Запустить HTTP-сервер для выдачи данных по ID: реализовать HTTP-эндпоинт, который по order_id будет возвращать данные заказа из кеша (JSON API). Если в кеше данных нет, можно подтягивать из БД.
- Разработать простой веб-интерфейс — страницу (HTML/JS), где можно ввести ID заказа и получить информацию о нём, обращаясь к вышеописанному HTTP API.
- Примечание: модель данных заказа (поля заказа, доставки, оплаты и товаров) прилагается в JSON-файле.

Данные, приходящие из очереди, могут быть невалидными — необходимо предусмотреть обработку ошибок (например, игнорируйте или логируйте некорректные сообщения). В ходе реализации убедитесь, что при сбоях (ошибка базы, падение сервиса) данные не теряются — используйте транзакции, механизм подтверждения сообщений от брокера и т.д.Что нужно сделать:


# Запуск
1. docker-compose build
2. docker-compose up

##  Вебморда: 
http://localhost:8081/

## Эндпойнт
http://localhost:8081/order/{uid}


## О реализации
- Использована гексагональная архитектура
- Применена имитация получения сообщений через Kafka - producer в данной реализации тестовый
- В качестве in-memory хранилища использован Redis
- Применен паттерн Cach-aside
- Кеш при перезапуске восстанавливается из БД
- Проверен golangci-lint